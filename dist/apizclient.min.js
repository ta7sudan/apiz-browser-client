/**
 * @Version 0.1.0
 * @Author: ta7sudan
 * @Repo: https://github.com/ta7sudan/apiz-browser-client#readme
 * @License: MIT
 */(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a["apiz-browser-client"]=b()})(this,function(){"use strict";function a(){return a=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},a.apply(this,arguments)}function b(){const a=new XMLHttpRequest;return Object.defineProperty(a,"_active",{value:!1,writable:!0,enumerable:!1}),a}function c(a){a._active=!1;try{a.timeout=0,a.requestURL=""}catch(a){}v.forEach(b=>a[b]=null),a.upload&&v.forEach(b=>a.upload[b]=null)}function d(){for(let a=0,b=s.length;a<b;++a)if(!s[a]._active)return s[a];return b()}function e(a){return r(a)?Object.keys(a).map(b=>Array.isArray(a[b])?a[b].map(a=>`${encodeURIComponent(b)}=${encodeURIComponent(a)}`).join("&"):`${encodeURIComponent(b)}=${encodeURIComponent(a[b])}`).join("&"):JSON.stringify(a)}function f({data:a,method:b,contentType:f=u.json,url:c,cache:d}){if(d||(c+=~c.indexOf("?")?`&_=${++w}`:`?_=${++w}`),"GET"===b||"HEAD"===b)return{url:c,data:a};if(a instanceof Document||a instanceof Blob||a instanceof FormData||a instanceof ArrayBuffer||a instanceof t||"string"==typeof a)return{url:c,data:a};if(o(f))a=JSON.stringify(a);else if(p(f))a=e(a);else throw new TypeError("Unknown data type, you can provide a custom serialize function in options to override the default.");return{url:c,data:a}}function g({data:a,contentType:b,acceptType:c}){let d=null;if(q(a)&&(o(b)||o(c)))try{d=JSON.parse(a)}catch(b){console.error("Invalid json string"),d=a}else d=a;return d}function h(a,b){r(b)&&Object.keys(b).forEach(c=>a.setRequestHeader(c,b[c]))}function i(a,b){r(b)&&a&&Object.keys(b).filter(a=>-1!==v.indexOf(a)).forEach(c=>a[c]=b[c])}function j(a,b){try{return a[b]}catch(a){return null}}function k(a){let{url:C=location.href,method:D="GET",contentType:b,beforeSend:e,complete:k,data:l,dataType:E="json",error:m,headers:o,mimeType:p,responseType:F="",username:r,password:s,success:t,timeout:G=0,ontimeout:v,events:w,uploadEvents:z,withCredentials:H=!1,cache:I=!0,serialize:A,deserialize:B}=a;if(D=D.toUpperCase().trim(),-1===["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"].indexOf(D))throw new Error(`Invalid HTTP method: ${D}`);if(q(b))u[b]&&(b=u[b]);else if(b)throw new TypeError("contentType could be \"json\", \"form\", \"html\", \"xml\", \"text\" or other custom string.");const J=n(A)?A:n(x)?x:f,K=n(B)?B:n(y)?y:g,L=/^([\w-]+:)\/\//.exec(C)[1],M=d(),N=n(k),O=n(m),P=n(t);let Q,R=!1,S=!1;if(({url:C,data:Q}=J({data:l,method:D,contentType:b,url:C,cache:I})),M._active=!0,M.open(D,C,!0,r,s),M.requestURL||(M.requestURL=C),b?M.setRequestHeader("Content-Type",b):q(Q)&&M.setRequestHeader("Content-Type",u.json),q(E)&&(u[E]&&(E=u[E]),M.setRequestHeader("Accept",E)),h(M,o),q(p)&&M.overrideMimeType(p),i(M,w),i(M.upload,z),H&&(M.withCredentials=H),F&&(M.responseType=F),G&&(M.timeout=G),n(v)?M.ontimeout=function(a){v(a),N&&k(this,"timeout")}:G&&!n(M.ontimeout)&&(M.ontimeout=function(){if(N)k(this,"timeout");else throw new Error(`Request ${this.requestURL} timeout.`)}),n(M.onloadend)){const a=M.onloadend;M.onloadend=function(b){c(this),a.call(this,b)}}else M.onloadend=function(){c(this)};return M.onreadystatechange=function(a){if(4===this.readyState)if(200<=this.status&&300>this.status||304==this.status||0==this.status&&"file:"==L){const b=this.getResponseHeader("Content-Type"),c=K({data:j(M,"responseXML")||j(M,"response")||j(M,"responseText"),contentType:b,acceptType:E});P&&t(c,this,a),N&&k(this,"success")}else if(0!==this.status){if(!O&&!N)throw new Error(`Remote server error. Request URL: ${this.requestURL}, Status code: ${this.status}, message: ${this.statusText}.`);O&&(R=!0,m(new Error(`Remote server error. Request URL: ${this.requestURL}, Status code ${this.status}`),this,a)),N&&(S=!0,k(this,"error"))}},M.onerror=function(a){if(!O&&!N)throw new Error(`An error occurred, maybe crossorigin error. Request URL: ${this.requestURL}, Status code: ${this.status}.`);!R&&O&&m(new Error(`Network error or browser restricted. Request URL: ${this.requestURL}, Status code: ${this.status}`),this,a),!S&&N&&k(this,"error")},n(e)?setTimeout(()=>{let b;try{b=e(M,a)}catch(a){throw c(M),a}!1===b?c(M):M.send(Q||null)}):M.send(Q||null),{abort(){M.abort()}}}function l({url:b,method:c,type:d,options:e,beforeSend:f,afterResponse:g}){let h;if(e instanceof Document||e instanceof Blob||e instanceof FormData||e instanceof ArrayBuffer||e instanceof z||"string"==typeof e)h=e,e={url:b,method:c,data:h};else if("[object Object]"===Object.prototype.toString.call(e))Object.assign(e,{url:b,method:c});else throw new TypeError("Options for tinyjx must be an object.");return new Promise((b,c)=>{k(a({dataType:d,beforeSend:f,success(a,d){try{g(a,d)}catch(a){return void c(a)}b(a)},error:c},e))})}function m(b={}){return a({},["get","head"].reduce((c,d)=>(c[d]=(c,e)=>l(a({url:c,method:d.toUpperCase(),options:e},b)),c),{}),["post","put","patch","delete","options"].reduce((c,d)=>(c[d]=(c,e)=>l(a({url:c,method:d.toUpperCase(),options:e},b)),c),{}))}const n=a=>"function"==typeof a,o=a=>/application\/json/i.test(a),p=a=>/application\/x-www-form-urlencoded/i.test(a),q=a=>a&&"string"==typeof a,r=a=>"[object Object]"===Object.prototype.toString.call(a),s=[],t=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor,u={json:"application/json",form:"application/x-www-form-urlencoded",html:"text/html",xml:"application/xml",text:"text/plain"},v=["onloadstart","onprogress","onabort","onerror","onload","ontimeout","onloadend","onreadystatechange"];let w=Date.now()+5,x=null,y=null;const z=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;return m});
//# sourceMappingURL=apizclient.min.js.map
