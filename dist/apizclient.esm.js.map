{"version":3,"file":"apizclient.esm.js","sources":["../node_modules/tinyjx/dist/tinyjx.esm.js","../src/index.js"],"sourcesContent":["function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\n/* global false */\nconst isFn = fn => typeof fn === 'function';\n\nconst isJSON = cType => /application\\/json/i.test(cType);\n\nconst isForm = cType => /application\\/x-www-form-urlencoded/i.test(cType);\n\nconst isStr = v => v && typeof v === 'string';\n\nconst isObj = o => Object.prototype.toString.call(o) === '[object Object]';\n\nconst xhrPool = [],\n      ArrayBufferView = Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array())).constructor,\n      MIME = {\n  json: 'application/json',\n  form: 'application/x-www-form-urlencoded',\n  html: 'text/html',\n  xml: 'application/xml',\n  text: 'text/plain'\n},\n      events = ['onloadstart', 'onprogress', 'onabort', 'onerror', 'onload', 'ontimeout', 'onloadend', 'onreadystatechange'];\nlet jsonpId = Date.now(),\n    cacheRand = Date.now() + 5,\n    globalSerialize = null,\n    globalDeserialize = null;\n\nfunction createXhr() {\n  const xhr = new XMLHttpRequest();\n  Object.defineProperty(xhr, '_active', {\n    value: false,\n    writable: true,\n    enumerable: false\n  });\n\n  return xhr;\n}\n\nfunction resetXhr(xhr) {\n  // responseType, withCredentials以及header相关的会在open后重置\n  xhr._active = false; // 可能是同步请求那就不能设置timeout\n\n  try {\n    xhr.timeout = 0;\n    xhr.requestURL = '';\n    /* eslint-disable-next-line */\n  } catch (e) {}\n\n  events.forEach(v => xhr[v] = null);\n  xhr.upload && events.forEach(v => xhr.upload[v] = null);\n}\n\nfunction xhrFactory() {\n  for (let i = 0, len = xhrPool.length; i < len; ++i) {\n    if (!xhrPool[i]._active) {\n      return xhrPool[i];\n    }\n  }\n\n  return createXhr();\n}\n\nfunction querystring(obj) {\n  if (isObj(obj)) {\n    return Object.keys(obj).map(k => Array.isArray(obj[k]) ? obj[k].map(v => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`).join('&') : `${encodeURIComponent(k)}=${encodeURIComponent(obj[k])}`).join('&');\n  } else {\n    return JSON.stringify(obj);\n  }\n}\n\nfunction defaultSerialize({\n  data,\n  method,\n  contentType = MIME.json,\n  url,\n  cache\n}) {\n  if (!cache) {\n    url += ~url.indexOf('?') ? `&_=${++cacheRand}` : `?_=${++cacheRand}`;\n  }\n\n  if (method === 'GET' || method === 'HEAD') {\n    return {\n      url,\n      data\n    };\n  }\n\n  if (data instanceof Document || // URLSearchParams和ReadableStream暂时不考虑支持了, 浏览器版本要求比较高\n  // data instanceof URLSearchParams ||\n  // data instanceof ReadableStream ||\n  data instanceof Blob || data instanceof FormData || data instanceof ArrayBuffer || data instanceof ArrayBufferView || typeof data === 'string') {\n    return {\n      url,\n      data\n    };\n  }\n\n  if (isJSON(contentType)) {\n    data = JSON.stringify(data);\n  } else if (isForm(contentType)) {\n    data = querystring(data);\n  } else {\n    throw new TypeError('Unknown data type, you can provide a custom serialize function in options to override the default.');\n  }\n\n  return {\n    url,\n    data\n  };\n}\n\nfunction defaultDeserialize({\n  data,\n  contentType,\n  acceptType\n}) {\n  let rst = null;\n\n  if (isStr(data) && (isJSON(contentType) || isJSON(acceptType))) {\n    try {\n      rst = JSON.parse(data);\n    } catch (e) {\n      console.error('Invalid json string');\n      rst = data;\n    }\n  } else {\n    rst = data;\n  }\n\n  return rst;\n}\n\nfunction setHeaders(xhr, headers) {\n  if (isObj(headers)) {\n    Object.keys(headers).forEach(k => xhr.setRequestHeader(k, headers[k]));\n  }\n}\n\nfunction setEvents(target, evts) {\n  if (isObj(evts) && target) {\n    // 不用addEventListener是它不方便reset\n    Object.keys(evts).filter(k => events.indexOf(k) !== -1).forEach(k => target[k] = evts[k]);\n  }\n}\n\nfunction jsonp(options) {\n  let {\n    url,\n    cache = false,\n    crossorigin,\n    callbackName,\n    success,\n    beforeSend,\n    complete,\n    error\n  } = options;\n  const hasOriginalCb = isFn(window[callbackName]);\n\n  if (isStr(callbackName) && !hasOriginalCb) {\n    throw new Error(`${callbackName} is not a function.`);\n  }\n\n  const hasSuccessCb = isFn(success),\n        hasErrorCb = isFn(error),\n        hasCompleteCb = isFn(complete),\n        originalCb = hasOriginalCb ? window[callbackName] : undefined;\n\n  if (!hasSuccessCb && !hasCompleteCb & !hasOriginalCb) {\n    throw new Error('Must set a success callback or complete callback.');\n  }\n\n  if (!isStr(url)) {\n    throw new TypeError(`url expected a non empty string, but received ${JSON.stringify(url)}.`);\n  }\n\n  const hasCustomCbName = isStr(callbackName),\n        cbName = hasCustomCbName ? callbackName : `jsonp${++jsonpId}`,\n        script = document.createElement('script');\n\n  if (url.split('?').length < 3) {\n    // 没有占位符的话默认callback\n    const qs = `callback=${encodeURIComponent(cbName)}`;\n    url = ~url.indexOf('?') ? `${url}&${qs}` : `${url}?${qs}`;\n  } else {\n    url = url.replace(/\\?(.+)=\\?/, `?$1=${encodeURIComponent(cbName)}`);\n  }\n\n  !cache && (url += `&_=${++cacheRand}`);\n\n  if (!window[cbName] || !window[cbName].hasHook) {\n    window[cbName] = function (...args) {\n      // 放前面, 防止后面的callback抛异常导致删不掉\n      if (!hasCustomCbName) {\n        delete window[cbName];\n      }\n\n      try {\n        if (hasOriginalCb) {\n          originalCb(...args);\n        } else if (hasSuccessCb) {\n          success(...args);\n        }\n\n        hasCompleteCb && complete('success');\n        hasOriginalCb && (window[callbackName] = originalCb);\n      } catch (e) {\n        // 个人觉得应该crash掉让用户修复异常而不是继续执行complete\n        // 所以这里只是为了还原window上原有的函数而不是为了吞掉异常\n        hasOriginalCb && (window[callbackName] = originalCb);\n        throw e;\n      }\n    };\n\n    window[cbName].hasHook = true;\n  }\n\n  script.onerror = function (e) {\n    document.body.removeChild(script);\n\n    if (!hasCustomCbName) {\n      delete window[cbName];\n    } // 都没有的话就继续抛出异常, 方便异常监控系统捕获\n\n\n    if (!hasErrorCb && !hasCompleteCb) {\n      throw new Error(`Load script ${url} failed.`);\n    }\n\n    hasErrorCb && error(new Error(`Load script ${url} failed.`), e);\n    hasCompleteCb && complete('error');\n  };\n\n  script.onload = () => setTimeout(() => document.body.removeChild(script), 3000);\n\n  crossorigin && (script.crossOrigin = crossorigin);\n  script.src = url;\n\n  if (isFn(beforeSend)) {\n    setTimeout(() => {\n      // 允许拦截掉不发送请求\n      const rst = beforeSend(url, options);\n      rst !== false && document.body.appendChild(script);\n    });\n  } else {\n    document.body.appendChild(script);\n  }\n}\n\nfunction getResponse(xhr, key) {\n  // 在有responseType的情况下, 访问responseXML, responseText等都有可能抛出异常\n  try {\n    return xhr[key];\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction ajax(options) {\n  let {\n    url = location.href,\n    method = 'GET',\n    contentType: reqCtype,\n    beforeSend,\n    complete,\n    data: reqRawData,\n    dataType: acceptType = 'json',\n    error,\n    headers,\n    mimeType,\n    responseType = '',\n    username,\n    password,\n    success,\n    timeout = 0,\n    ontimeout,\n    events,\n    uploadEvents,\n    withCredentials = false,\n    cache = true,\n    serialize,\n    deserialize\n  } = options;\n  method = method.toUpperCase().trim(); // IE是什么...\n  // xhr不支持CONNECT, TRACE, TRACK方法\n\n  if (!(['GET', 'POST', 'PUT', 'PATCH', 'DELETE', 'HEAD', 'OPTIONS'].indexOf(method) !== -1)) {\n    throw new Error(`Invalid HTTP method: ${method}`);\n  } // 允许所有callback都没有\n  // 准备数据\n\n\n  if (isStr(reqCtype)) {\n    MIME[reqCtype] && (reqCtype = MIME[reqCtype]);\n  } else if (reqCtype) {\n    throw new TypeError('contentType could be \"json\", \"form\", \"html\", \"xml\", \"text\" or other custom string.');\n  }\n\n  const slz = isFn(serialize) ? serialize : isFn(globalSerialize) ? globalSerialize : defaultSerialize,\n        dslz = isFn(deserialize) ? deserialize : isFn(globalDeserialize) ? globalDeserialize : defaultDeserialize,\n        protocol = /^([\\w-]+:)\\/\\//.exec(url)[1],\n        xhr = xhrFactory(),\n        hasCompleteCb = isFn(complete),\n        hasErrorCb = isFn(error),\n        hasSuccessCb = isFn(success);\n  let reqData,\n      errCalled = false,\n      completeCalled = false; // 这里不用捕获异常去重置xhr是因为xhr还没激活\n\n  ({\n    url,\n    data: reqData\n  } = slz({\n    data: reqRawData,\n    method,\n    contentType: reqCtype,\n    url,\n    cache\n  })); // 初始化xhr\n\n  xhr._active = true;\n  xhr.open(method, url, true, username, password);\n  !xhr.requestURL && (xhr.requestURL = url); // 设置必要的头部\n\n  if (reqCtype) {\n    xhr.setRequestHeader('Content-Type', reqCtype);\n  } else if (isStr(reqData)) {\n    // 不在默认参数设json是为了让FormData之类的能够由浏览器自己设置\n    // 这里只对字符串的body设置默认为json\n    xhr.setRequestHeader('Content-Type', MIME.json);\n  }\n\n  if (isStr(acceptType)) {\n    MIME[acceptType] && (acceptType = MIME[acceptType]);\n    xhr.setRequestHeader('Accept', acceptType);\n  }\n\n  setHeaders(xhr, headers);\n  isStr(mimeType) && xhr.overrideMimeType(mimeType); // 主要是给progress等事件用, 但存在破坏封装的风险\n\n  setEvents(xhr, events);\n  setEvents(xhr.upload, uploadEvents);\n  withCredentials && (xhr.withCredentials = withCredentials);\n  responseType && (xhr.responseType = responseType);\n  timeout && (xhr.timeout = timeout);\n\n  if (isFn(ontimeout)) {\n    xhr.ontimeout = function (e) {\n      ontimeout(e);\n      hasCompleteCb && complete(this, 'timeout');\n    };\n  } else if (timeout && !isFn(xhr.ontimeout)) {\n    xhr.ontimeout = function () {\n      if (hasCompleteCb) {\n        complete(this, 'timeout');\n      } else {\n        // 如果没监听ontimeout但是设置了timeout, window.onerror不会捕获这个错误, 所以手动抛个\n        throw new Error(`Request ${this.requestURL} timeout.`);\n      }\n    };\n  } // loadend无论同步还是异步请求, 无论前面的事件是否抛异常, 它都会执行\n\n\n  if (isFn(xhr.onloadend)) {\n    const originalLoadend = xhr.onloadend;\n\n    xhr.onloadend = function (e) {\n      resetXhr(this);\n      originalLoadend.call(this, e);\n    };\n  } else {\n    xhr.onloadend = function () {\n      resetXhr(this);\n    };\n  } // 覆盖掉用户自定义onreadystatechange\n\n\n  xhr.onreadystatechange = function (e) {\n    if (this.readyState === 4) {\n      if (this.status >= 200 && this.status < 300 || this.status == 304 || this.status == 0 && protocol == 'file:') {\n        const resCtype = this.getResponseHeader('Content-Type'); // 这里也不用捕获异常, 因为xhr.onloadend会在之后帮我们回收xhr\n\n        const resData = dslz({\n          data: getResponse(xhr, 'responseXML') || getResponse(xhr, 'response') || getResponse(xhr, 'responseText'),\n          contentType: resCtype,\n          acceptType\n        }); // 异常直接抛\n\n        hasSuccessCb && success(resData, this, e);\n        hasCompleteCb && complete(this, 'success');\n      } else if (this.status !== 0) {\n        // 这类错误xhr.onerror和window.onerror都不捕获所以手动抛一个\n        if (!hasErrorCb && !hasCompleteCb) {\n          throw new Error(`Remote server error. Request URL: ${this.requestURL}, Status code: ${this.status}, message: ${this.statusText}, response: ${this.responseText}.`);\n        } // 理论上来讲好像没必要再注册xhr.onerror了, 因为如果有error那status必然为0\n        // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/status\n        // 但是不加个心里不踏实...总感觉会不会有浏览器没按规范实现\n        // 不过知名的库页都没监听onerror, 那说明应该是都按规范实现了的\n        // 但是我要加!!!\n\n\n        if (hasErrorCb) {\n          errCalled = true;\n          error(new Error(`Remote server error. Request URL: ${this.requestURL}, Status code: ${this.status}, message: ${this.statusText}, response: ${this.responseText}.`), this, e);\n        }\n\n        if (hasCompleteCb) {\n          completeCalled = true;\n          complete(this, 'error');\n        }\n      }\n    }\n  }; // 覆盖\n\n\n  xhr.onerror = function (e) {\n    // 跨域错误会在这里捕获, 但是window.onerror不捕获, 所以也手动抛一个\n    if (!hasErrorCb && !hasCompleteCb) {\n      throw new Error(`An error occurred, maybe crossorigin error. Request URL: ${this.requestURL}, Status code: ${this.status}.`);\n    }\n\n    if (!errCalled && hasErrorCb) {\n      error(new Error(`Network error or browser restricted. Request URL: ${this.requestURL}, Status code: ${this.status}`), this, e);\n    }\n\n    if (!completeCalled && hasCompleteCb) {\n      complete(this, 'error');\n    }\n  }; // 哎...都异步吧\n\n\n  if (isFn(beforeSend)) {\n    setTimeout(() => {\n      let rst;\n\n      try {\n        rst = beforeSend(xhr, options);\n      } catch (e) {\n        // 恶心之处就在于每个用户定义的callback都可能触发异常, 然而我还要回收xhr\n        resetXhr(xhr);\n        throw e;\n      }\n\n      if (rst !== false) {\n        xhr.send(reqData || null);\n      } else {\n        resetXhr(xhr);\n      }\n    });\n  } else {\n    xhr.send(reqData || null);\n  } // 不暴露xhr\n\n\n  return {\n    abort() {\n      xhr.abort();\n    }\n\n  };\n}\n\nfunction config({\n  pool = false,\n  serialize,\n  deserialize\n} = {}) {\n  if (pool) {\n    xhrPool.length = 0;\n    let poolSize = typeof pool === 'number' ? pool : 5;\n\n    if (poolSize < 0) {\n      throw new Error('pool size must >= 0');\n    }\n\n    while (poolSize--) {\n      xhrPool.push(createXhr());\n    }\n  }\n\n  isFn(serialize) && (globalSerialize = serialize);\n  isFn(deserialize) && (globalDeserialize = deserialize);\n}\nfunction get(url, options) {\n  return ajax(_extends({}, options, {\n    url,\n    method: 'GET'\n  }));\n}\nfunction head(url, options) {\n  return ajax(_extends({}, options, {\n    url,\n    method: 'HEAD'\n  }));\n}\nfunction post(url, data, options) {\n  return ajax(_extends({}, options, {\n    url,\n    data,\n    method: 'POST'\n  }));\n}\nfunction put(url, data, options) {\n  return ajax(_extends({}, options, {\n    url,\n    data,\n    method: 'PUT'\n  }));\n}\nfunction del(url, data, options) {\n  return ajax(_extends({}, options, {\n    url,\n    data,\n    method: 'DELETE'\n  }));\n}\nfunction patch(url, data, options) {\n  return ajax(_extends({}, options, {\n    url,\n    data,\n    method: 'PATCH'\n  }));\n}\nfunction options(url, data, options) {\n  return ajax(_extends({}, options, {\n    url,\n    data,\n    method: 'OPTIONS'\n  }));\n}\n\nexport { config, ajax, jsonp, get, head, post, put, del, patch, options };\n//# sourceMappingURL=tinyjx.esm.js.map\n","/* global DEBUG */\nimport { ajax } from 'tinyjx';\n\nconst retryMap = {};\nlet reqId = Date.now();\n\nfunction request(opts) {\n\tlet { url, method, type, data, beforeSend, afterResponse, retry = 0, options = {}, id = ++reqId } = opts;\n\tif (!retryMap[id]) {\n\t\tretryMap[id] = {\n\t\t\tcount: 0,\n\t\t\tretry\n\t\t};\n\t\topts.id = id;\n\t}\n\tif (data) {\n\t\toptions.data = data;\n\t\toptions.contentType = type;\n\t}\n\toptions.url = url;\n\toptions.method = method;\n\treturn new Promise((rs, rj) => {\n\t\tajax({\n\t\t\tbeforeSend,\n\t\t\tsuccess(data, xhr) {\n\t\t\t\tdelete retryMap[id];\n\t\t\t\ttry {\n\t\t\t\t\ttypeof afterResponse === 'function' && afterResponse(data, xhr);\n\t\t\t\t} catch (e) {\n\t\t\t\t\trj(e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\trs(data);\n\t\t\t},\n\t\t\terror(err) {\n\t\t\t\tif (retryMap[id].count < retryMap[id].retry) {\n\t\t\t\t\t++retryMap[id].count;\n\t\t\t\t\trs(request(opts));\n\t\t\t\t} else {\n\t\t\t\t\tdelete retryMap[id];\n\t\t\t\t\trj(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\t...options\n\t\t});\n\t});\n}\n\n/**\n * { beforeSend, afterResponse, retry }\n */\nexport default function (opts = {}) {\n\treturn {\n\t\t...['get', 'head'].reduce((prev, cur) =>\n\t\t\t(prev[cur] = (url, options) => request({\n\t\t\t\t...opts,\n\t\t\t\turl,\n\t\t\t\tmethod: cur.toUpperCase(),\n\t\t\t\toptions\n\t\t\t}), prev), {}),\n\t\t...['post', 'put', 'patch', 'delete', 'options'].reduce((prev, cur) =>\n\t\t\t(prev[cur] = (url, bodyOrOptions, type, isOptions) => request({\n\t\t\t\t...opts,\n\t\t\t\turl,\n\t\t\t\ttype,\n\t\t\t\tmethod: cur.toUpperCase(),\n\t\t\t\tdata: isOptions ? undefined : bodyOrOptions,\n\t\t\t\toptions: isOptions ? bodyOrOptions : undefined\n\t\t\t}), prev), {})\n\t};\n}\n"],"names":["retryMap","reqId","Date","now","request","opts","url","method","type","data","beforeSend","afterResponse","retry","options","id","count","contentType","Promise","rs","rj","ajax","success","xhr","e","error","err","reduce","prev","cur","toUpperCase","bodyOrOptions","isOptions","undefined"],"mappings":"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"}